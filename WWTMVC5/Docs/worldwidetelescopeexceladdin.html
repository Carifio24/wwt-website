<HTML>

<head>
<title>WorldWide Telescope Add-in for Excel</title>

 <link rel=stylesheet href="SDK_style.css" type="text/css" media=screen>

<style type="text/css">
.style1 {
	font-size: 10pt;
}
</style>

</head>

<body>

<h1><a name="WorldWide Telescope Excel Add-in">WorldWide Telescope Add-in for Excel</a></h1>
<p><font color="red">Note: This documentation is preliminary and subject to change.</font></p>
<p><img alt="" height="27" src="YesNo.bmp" width="220"></p>
<p>This document describes how to use the Microsoft WorldWide Telescope Add-in for Excel 
with WorldWide Telescope. The add-in enables a range of data sets to be visualized in 
WorldWide Telescope, including event data based on latitude and longitude (or RA 
and Dec if it is space based data), and geometry data specified in Well Known 
Text (WKT).&nbsp; As changes are made to the Excel data, the add-in enables the 
visualization to change dynamically to match the new data.</p>
<h2>Table of Contents</h2>
<ul>
	<li><a href="#Setup">Setup</a></li>
	<ul>
	<li><a href="#Uninstall">Uninstall</a></li></ul>
	<li><a href="#UI_Elements">UI Elements</a></li>
	<ul>
	<li><a href="#Capture_Viewpoint_Dialog">Capture Viewpoint Dialog</a></li>
	<li><a href="#Manage_Viewpoints_Dialog">Manage Viewpoints Dialog</a></li>
	<li><a href="#Layer_Manager_Pane">Layer Manager Pane</a></li>
	<ul>
		<li><a href="#Marker_Types">Marker Types</a></li>
		<li><a href="#Color_Column_Formats">Color_Column_Formats</a></li>
		<li><a href="#Excel_Shortcuts">Excel_Shortcuts</a></li>
	</ul>
		<li><a href="#Remote_Connections">Remote Connections</a></li></ul>
	<li><a href="#Tutorial_One_Earthquake_data">Tutorial One: Earthquake Data</a></li>
	<li><a href="#Tutorial_Two_Geometry_data">Tutorial Two: Geometry Data</a></li>
</ul>
<h4>See Also</h4>
<ul type="disc">
<li><a href="http://www.worldwidetelescope.org/Home.aspx">WorldWide Telescope</a></li>
</ul>
<hr>
<h2><a name="Setup">Setup</a></h2>
<p>The recommended setup is to have two monitors, one running WorldWide 
Telescope, and one the Excel Add-in.</p>
<ol>
	<li>Close Microsoft Excel, if it is open.</li>
	<li>Run the installation package, WWTExcelAddin.msi.</li>
	<li>Open Microsoft Excel, the main menu item <strong>WWT </strong>should now appear.</li>
</ol>
<h4><a name="Uninstall">Uninstall</a></h4>
<p>To uninstall the Excel Add-in go to the <strong>Control Panel</strong> and 
remove the program <strong>WorldWide Telescope Add-in for Excel</strong>, the same process as for any other application.</p>
<h4>Updates</h4>
<p>If an update is available for the Add-in, a button will be added to the 
ribbon and to the Layer Manager pane. Click one of the buttons to install the update.</p>
<h4>See Also</h4>
<ul>
	<li><a href="#WorldWide Telescope Excel Add-in">WorldWide Telescope Add-in for Excel</a></li>
</ul>
<hr>
<h2><a name="UI_Elements">UI Elements</a></h2>
<p>Click on the <strong>WWT </strong>main entry to bring up the WWT 
ribbon.</p>
<table class="T1" cellpAdd-ing="4" cellspacing="4">
<tr><td>
	<img alt="" height="112" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EARibbon.png" width="722"></td></tr>
<tr><td><strong>Visualize Selection</strong> will bring up the <strong>Layer Manager 
	pane</strong>, and attempt to map the headings in the data to the correct WorldWide 
	Telescope labels. <br><br><strong>Layer</strong> <strong>Manager</strong> is 
	a toggle, showing or hiding the <strong><a href="#Layer_Manager_Pane">Layer Manager pane</a></strong>.<br><br>Click the down 
	arrow of <strong>View Samples</strong> to list a range of sample data. The 
	sample data files include viewing instructions, as some parameters need to 
	be changed from the defaults to view the data correctly.<br>
	<br><strong>Capture</strong> <strong>Viewpoint</strong> will get the current 
	view from WorldWide Telescope and display it in the <strong>
	<a href="#Capture_Viewpoint_Dialog">Capture Viewpoint 
	dialog</a></strong>.<br><br><strong>Go To Viewpoint</strong> will change the WorldWide 
	Telescope view to the one selected in the <strong>
	<a href="#Manage_Viewpoints_Dialog">Manage Viewpoints dialog</a></strong>.<br><br>
	<strong>Manage</strong> <strong>Viewpoints</strong> will show the current 
	range of captured viewpoints.<br><br><strong>Go To Viewpoint from data</strong> 
	will change the view of WorldWide Telescope to a latitude and longitude (and 
	reference frame) of a layer, if an active cell has been selected on a row 
	that contains a latitude and longitude (or RA and Dec) and the layer is 
	linked with WorldWide Telescope.<br><br><strong>Connect Remotely</strong> enables a machine name 
	or IP address of a computer on the intranet to be entered, and then this 
	computer will receive the layer data (see <a href="#Remote_Connections">
	Remote Connections</a>).<br><br>
	<strong>Contact Us</strong> and <strong>Feedback</strong> provide a range of 
	options for providing Microsoft Research with information<strong>, WWT Add-in 
	for Excel Help</strong> will bring up this help file.</td></tr>
</table>
<h4>See Also</h4>
<ul>
	<li><a href="#WorldWide Telescope Excel Add-in">WorldWide Telescope Add-in for Excel</a></li>
</ul>
<hr>
<h3><a name="Capture_Viewpoint_Dialog">Capture Viewpoint Dialog</a></h3>

<table class="T1" cellpAdd-ing="4" cellspacing="4">
<tr><td>
	<img alt="" height="395" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EACaptureViewpoint.png" width="320"></td><td>
	Enter a friendly name in the <strong>Name</strong> field.<br><br>Depending 
	on the view captured the properties will vary slightly, with planet or moon 
	objects displaying Lat and Long, and sky views displaying RA and Dec.</td></tr>
</table>
<h4>See Also</h4>
<ul>
	<li><a href="#UI_Elements">UI Elements</a></li>
	<li><a href="#WorldWide Telescope Excel Add-in">WorldWide Telescope Add-in for Excel</a></li>
</ul>
<hr>
<h3><a name="Manage_Viewpoints_Dialog">Manage Viewpoints Dialog</a></h3>

<table class="T1" cellpAdd-ing="4" cellspacing="4">
<tr><td>
	<img alt="" height="480" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EAManageViewpoints.png" width="1173"></td></tr>
<tr><td>The viewpoints cannot be edited after they are entered in the list, 
	except that they can be renamed.<br><br>The viewpoints are saved along with 
	the Excel workbook, so be sure to save off the file even if the data itself 
	has not changed but a range of viewpoints has been captured.</td></tr>
</table>
<h4>See Also</h4>
<ul>
	<li><a href="#UI_Elements">UI Elements</a></li>
	<li><a href="#WorldWide Telescope Excel Add-in">WorldWide Telescope Add-in for Excel</a></li>
</ul>
<hr>



<h3><a name="Layer_Manager_Pane">Layer Manager Pane</a></h3>
<table class="T1" cellpAdd-ing="8" cellspacing="8">
<tr><td>
	<img alt="" height="609" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EAMapColumns.png" width="315"></td>
	<td style="width: 524px">
	The<strong> Layer Manager</strong> pane is the control center for the add-in.<br><br>The 
	<strong>Select Layer</strong> drop down list will show all the current 
	layers (data sets) and whether they are linked or not linked with WorldWide Telescope.<br><br>
	Associated with each layer is a range of rows, this range can be 
	discontinuous but must all include the same columns. <strong>Show Range</strong> will show 
	the row selection for the selected layer.<br><br><strong>Update</strong>
	<strong>Range</strong> will make the 
	current row selection the range for the layer, and also show the <strong>View in WWT</strong> 
	button. Press the <strong>View in WWT</strong> button to see the changes in WorldWide 
	Telescope.<br><br>If a layer is linked <strong>Delete Layer</strong> will 
	delete the layer from WorldWide Telescope, and delete the layer mappings in 
	the Add-in. If the layer is not linked, then only the mappings in the Add-in 
	are deleted.<br><br>The 
	<strong>Refresh</strong> button may 
	also show <strong>Get Layer Data</strong>. These two are used to synchronize layers with 
	WorldWide Telescope and perhaps a second set of the same data open in a 
	separate data sheet in Excel. <strong>Get Layer Data</strong> will load in the layer that is 
	highlighted in WorldWide Telescope. <strong>Refresh</strong> will update the data in Excel 
	with any changes that may have been made either in WorldWide Telescope or 
	the other Excel worksheet.<br><br>The Layer Name is the friendly name for 
	the layer, a default in the form <em>&quot;sheetN_N</em>&quot; is automatically 
	generated, change this to something more descriptive.<br><br><strong>Reference</strong>
	<strong>Frame</strong> 
	is the Solar System object that the data applies to, often <strong>Earth</strong> but it 
	could be any other planet or moon.<br><br>The <strong>Map Columns </strong>tab shows the 
	mapping between Excel columns and the required labels within WorldWide 
	Telescope. The best fitting labels will be selected by the add-in, but they 
	can easily be changed if this is not correct. Often it makes sense to label 
	the Excel columns with names that match the labels (<strong>Latitude</strong>, 
	<strong>Longitude</strong>, and so on).</td></tr>
<tr><td>
	<img alt="" height="385" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EALayer.png" width="299"></td>
	<td style="width: 524px">
	<br>The <strong>Layer</strong> tab allows a number of properties of the layer to be changed if 
	the defaults are not what is required.<br><br>The <strong>Fade type</strong> 
	and <strong>Fade time</strong> apply to the visualization graphic - whether 
	it should appear and disappear instantly or be faded.</td></tr>
<tr><td>
	<img alt="" height="593" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EAMarker.png" width="296"></td>
	<td style="width: 524px">
	<br><br>The <strong>Marker</strong> tab refers particularly to the graphic that is used to render the 
	events in the data. <br><br>The color determines the color of the marker in 
	WorldWide Telescope used to render each of the events in the spreadsheet. <br>
	<br>The <strong>Hover Text</strong> is simply the text that is rendered in a 
	tooltip box if the user hovers over the marker.<br><br>For earthquake data for example the size of the 
	marker 
	is taken from the magnitude and scaled according to a <strong>Power</strong>. Other 
	data may use one of the other scaling options: <strong>Constant</strong>, 
	<strong>Log</strong>, <strong>Linear</strong> or 
	<strong>Stellar Magnitude</strong>.<br><br>The <strong>Scale Relative</strong> 
	determines whether the scaling is done relative to the size of the object (<strong>World</strong>) 
	or to the current view (<strong>Screen</strong>).<br><br>In addition to the scaling type, a 
	<strong>Scale factor</strong> (a 
	multiplier) is applied to the size of the marker graphic.<br><br><strong>
	<a href="#Marker_Types">Marker Type</a></strong> 
	can be one of <strong>Gaussian</strong>, <strong>Point</strong> or <strong>
	PushPin</strong>. <br><br>If checked, <strong>Show Far Side Markers</strong> 
	indicates that markers on the far side of the World should be rendered.<br>
	<br>The <strong>TimeDecay</strong> gives the time, in days, that the marker 
	takes to fade out.</td></tr>
</table>

<h4><a name="Marker_Types">Marker Types</a></h4>
<table class="T2" cellpadding="8" cellspacing="0.5" rules="rows" bordercolorlight="white">
<tr><td><img alt="" height="383" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/Markers.png" width="583"></td><td>
	The images show Gaussian, Point and Pushpin markers respectively.</td></tr>
</table>

<h4><a name="Color_Column_Formats">Color Column Formats</a></h4>
<p>The following are accepted formats for color column entries, note that they 
are case insensitive.</p>
<table class="T1" cellpadding="8" cellspacing="0.5" rules="rows" bordercolorlight="white">
<tr class="H"><td><h5>Entry</h5></td><td>
	<h5>Examples</h5>
	</td></tr>
<tr><td>Color name</td><td>Red<br>Aquamarine</td></tr>
<tr><td>Transparency</td><td>75% Red<br>50% Goldenrod</td></tr>
<tr><td>ARGB Hex</td><td>FFFFFFFF<br>08ff9933<br><br>Note the alpha value should 
		be FF for solid color, 80 for 50% transparency.</td></tr>
<tr><td>Formula</td><td>=IF(H9&lt;4.5,&quot;White&quot;,IF(H9&lt;5,&quot;75% Green&quot;,IF(H9&lt;6,&quot;Orange&quot;,&quot;Red&quot;)))<br>
		<br>This formula checks an earthquake magnitude in cell H9.</td></tr>
</table>
<h4><a name="Excel_Shortcuts">Excel Shortcuts</a></h4>
<p>The following table lists some useful Excel shortcuts:</p>
<table class="T1" cellpadding="8" cellspacing="0.5" rules="rows" bordercolorlight="white">
<tr class="H"><td><h5>Task</h5></td><td class="style1">
	<h5>Shortcut</h5>
	</td></tr>
<tr><td>To select the whole range of data.</td><td>Highlight the top left cell 
	of the range.<br>Click Ctrl-Shift down arrow, then right arrow.</td></tr>
<tr><td>To change all the entries in a column to one value or formula.</td><td>
	Highlight the cell that contains the correct value.<br>Double left click the 
	lower right hand corner of the cell.</td></tr>
<tr><td>To combine data from multiple sheets.</td><td>
	Enter the formula<strong> =vloopup</strong>. This looks across datasheets 
	for corresponding columns. The spreadsheet must be sorted in ascending 
	order.</td></tr>
</table>
<h4>Saving Data</h4>
<p>The Excel spreadsheets should be saved to .xlsx files, as this preserves the 
visualization properties set while using the Add-in.</p>
<p>To access previously saved layers, click on the <strong>Layer Manager</strong> 
icon in the WWT ribbon, and select the saved layer from the <strong>Select Layer</strong> 
drop-down list.</p>
<p>Layer properties that are set in the application, WorldWide Telescope, and 
not the Add-in, will not be reflected in the Add-in, and updates made using the 
Add-in will overwrite the properties changed directly into WorldWide Telescope.</p>
<h4>See Also</h4>
<ul>
	<li><a href="#UI_Elements">UI Elements</a></li>
	<li><a href="#WorldWide Telescope Excel Add-in">WorldWide Telescope Add-in for Excel</a></li>
</ul>
<hr>

<h3><a name="Remote_Connections">Remote Connections</a></h3>
<p>The option of a remote connection is enabled to provide the ability to run 
the add-in on a laptop or desktop computer, but to have the output displayed on 
a large screen being controlled by another computer.</p>
<table class="T1" cellpAdd-ing="8" cellspacing="8">
<tr><td>
	<img alt="" height="190" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EARemote.png" width="255"></td><td>
	Enter a machine name or IP address of a machine that is currently running 
	WorldWide Telescope on the organizations intranet. <br><br>Installation of 
	WorldWide Telescope sets up port 5050 for remote connection, no further 
	permission setting on the remote machine is required.<br><br>The remote 
	machine now receives the data from the Excel add-in (rather the local 
	version of WorldWide Telescope), and the full functionality of the add-in 
	(including the receiving of layer updates) is available. There are security 
	settings in WorldWide Telescope to allow and disallow connections from 
	different IP addresses.<br></td></tr>
</table>
<h4>See Also</h4>
<ul>
	<li><a href="#UI_Elements">UI Elements</a></li>
	<li><a href="#WorldWide Telescope Excel Add-in">WorldWide Telescope Add-in for Excel</a></li>
</ul>

<hr>
<h2><a name="Tutorial_One_Earthquake_data">Tutorial One: Earthquake Data</a></h2>
<p>Go through the following steps to visualize the earthquake data for the 
period January 9th to September 9th 2009.</p>
<ol>
	<li>Ensure WorldWide Telescope is running.</li>
	<li>In Excel, select the <strong>WWT</strong> menu item, then <strong>View 
Samples</strong>, choose <strong>Earth Based Point Data Sample</strong>.</li>
	<li>In the drop down list just below the ribbon, select <strong>Earthquakes</strong>.
	<table class="T1" cellpAdd-ing="4" cellspacing="4">
<tr><td>
	<img alt="" height="165" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EAQuickSelect.png" width="170"></td></tr>
</table>

	</li>
	<li>Click <strong>Visualize Selection</strong>.
	<table class="T1" cellpAdd-ing="4" cellspacing="4">
<tr><td>
	<img alt="" height="800" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EAEarthquake.png" width="1280"></td></tr>
</table>
</li>
	<li>In the <strong>Layer Manager</strong> ensure that the <strong>Reference Frame</strong> 
is set to <strong>Earth</strong>.</li>
	<li>Click <strong>View in WWT</strong>. In WorldWide Telescope ensure that 
	the simulated time rate has been accelerated to about <strong>x1000000</strong>, 
	and you should now see the earthquake visualization.</li>
</ol>
<table class="T1" cellpAdd-ing="4" cellspacing="4">
<tr><td>
	<img alt="" height="525" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EAEarthquakeDisplay.png" width="840"></td></tr>
<tr><td>Notice that the positions of the earthquake graphic include an altitude 
	(a depth in this case).</td></tr>
</table>
<h4>See Also</h4>
<ul>
	<li><a href="#Tutorial_One_Earthquake_data">Tutorial One: Earthquake Data</a></li>
	<li><a href="#WorldWide Telescope Excel Add-in">WorldWide Telescope Add-in for Excel</a></li>
</ul>
<hr>
<h2><a name="Tutorial_Two_Geometry_data">Tutorial Two: Geometry Data</a></h2>
<p>Go through the following steps to visualize some countries and regions of the 
World.</p>
<ol>
	<li>Ensure WorldWide Telescope is running.</li>
	<li>In Excel, select the <strong>WWT</strong> menu item, then <strong>View 
Samples</strong>, choose <strong>Earth Based Geometry Data Sample</strong>.</li>
	<li>In the drop down list just below the ribbon, select <strong>
	Countries_Regions</strong>.
	<table class="T1" cellpAdd-ing="4" cellspacing="4">
<tr><td>
	<img alt="" height="166" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EAQuickSelect2.png" width="171"></td></tr>
</table>

	</li>
	<li>Click <strong>Visualize Selection</strong>.</li>


<table class="T1" cellpAdd-ing="4" cellspacing="4">
<tr><td>
	<img alt="" height="597" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EAGeometry.png" width="828"></td></tr>
</table>
<li>In the <strong>Layer Manager</strong> ensure that the <strong>Reference Frame</strong> 
is set to <strong>Earth</strong>.</li>
	<li>Click <strong>View in WWT</strong>.
<table class="T1" cellpAdd-ing="4" cellspacing="4">
<tr><td>
	<img alt="" height="712" src="//wwtweb.blob.core.windows.net/docs/exceladdinimages/EAGeometryDisplay.png" width="836"></td></tr>
</table>
</ol>
<h4>See Also</h4>
<ul>
	<li><a href="#Tutorial_Two_Geometry_data">Tutorial Two: Geometry Data</a></li>
	<li><a href="#WorldWide Telescope Excel Add-in">WorldWide Telescope Add-in for Excel</a></li>
</ul>

</body>
</html>
